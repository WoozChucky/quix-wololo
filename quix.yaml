# Quix Project Descriptor
# This file describes the data pipeline and configuration of resources of a Quix Project.

metadata:
  version: 1.0

# This section describes the Deployments of the data pipeline
deployments:
  - name: Alerts dashboard
    application: Alerts dashboard
    deploymentType: Service
    version: f6277e726dbbe99ee6ccfc16b18abbbd2b6d4766
    resources:
      cpu: 200
      memory: 500
      replicas: 1
    publicAccess:
      enabled: true
      urlPrefix: alertsdashboard-f6277e7
    desiredStatus: Running
    variables:
      - name: input
        inputType: InputTopic
        description: Name of the input topic to listen to.
        required: false
        value: metrics-alerts
      - name: storage_version
        inputType: FreeText
        description: Version of state. Bump up this variable to reset the state.
        required: false
        value: 1.0
  - name: Pod Metrics Source - workspace
    application: Logs Source
    deploymentType: Service
    version: 1ca018be6691873fb98126955b74543acb2781ef
    resources:
      cpu: 200
      memory: 500
      replicas: 1
    desiredStatus: Running
    variables:
      - name: output
        inputType: OutputTopic
        description: ''
        required: true
        value: k8s-metrics
      - name: K8SEndpoint
        inputType: Secret
        description: ''
        required: true
        secretKey: K8SEndpoint
      - name: K8SClusterCertificateAuthorityData
        inputType: Secret
        description: ''
        required: true
        secretKey: K8SClusterCertificateAuthorityData
      - name: K8SClientCertificateData
        inputType: Secret
        description: ''
        required: true
        secretKey: K8SClientCertificateData
      - name: K8SClientKeyData
        inputType: Secret
        description: ''
        required: true
        secretKey: K8SClientKeyData
      - name: K8SToken
        inputType: Secret
        description: ''
        required: true
        secretKey: K8SToken
      - name: K8SClusterName
        inputType: FreeText
        description: ''
        required: true
        value: DevCluster
      - name: K8SNamespace
        inputType: FreeText
        description: ''
        required: false
        value: quixdev-nuno-dev
  - name: Node Metrics Source
    application: Logs Source
    deploymentType: Service
    version: 1ca018be6691873fb98126955b74543acb2781ef
    resources:
      cpu: 200
      memory: 500
      replicas: 1
    desiredStatus: Running
    variables:
      - name: output
        inputType: OutputTopic
        description: ''
        required: true
        value: k8s-metrics
      - name: K8SEndpoint
        inputType: Secret
        description: ''
        required: true
        secretKey: K8SEndpoint
      - name: K8SClusterCertificateAuthorityData
        inputType: Secret
        description: ''
        required: true
        secretKey: K8SClusterCertificateAuthorityData
      - name: K8SClientCertificateData
        inputType: Secret
        description: ''
        required: true
        secretKey: K8SClientCertificateData
      - name: K8SClientKeyData
        inputType: Secret
        description: ''
        required: true
        secretKey: K8SClientKeyData
      - name: K8SToken
        inputType: Secret
        description: ''
        required: true
        secretKey: K8SToken
      - name: K8SClusterName
        inputType: FreeText
        description: ''
        required: true
        value: DevCluster
      - name: K8SNamespace
        inputType: FreeText
        description: ''
        required: false
        value: ''
  - name: Pod Metrics Source - Default
    application: Logs Source
    deploymentType: Service
    version: 1ca018be6691873fb98126955b74543acb2781ef
    resources:
      cpu: 200
      memory: 500
      replicas: 1
    desiredStatus: Running
    variables:
      - name: output
        inputType: OutputTopic
        description: ''
        required: true
        value: k8s-metrics
      - name: K8SEndpoint
        inputType: Secret
        description: ''
        required: true
        secretKey: K8SEndpoint
      - name: K8SClusterCertificateAuthorityData
        inputType: Secret
        description: ''
        required: true
        secretKey: K8SClusterCertificateAuthorityData
      - name: K8SClientCertificateData
        inputType: Secret
        description: ''
        required: true
        secretKey: K8SClientCertificateData
      - name: K8SClientKeyData
        inputType: Secret
        description: ''
        required: true
        secretKey: K8SClientKeyData
      - name: K8SToken
        inputType: Secret
        description: ''
        required: true
        secretKey: K8SToken
      - name: K8SClusterName
        inputType: FreeText
        description: ''
        required: true
        value: DevCluster
      - name: K8SNamespace
        inputType: FreeText
        description: ''
        required: false
        value: default
  - name: Memory Alert Detector - nodes
    application: Threshold alert
    deploymentType: Service
    version: e4b050775ca4107c716ceff79116746f01547944
    resources:
      cpu: 200
      memory: 500
      replicas: 1
    desiredStatus: Running
    variables:
      - name: input
        inputType: InputTopic
        description: This is the input topic for raw data
        required: true
        value: k8s-metrics
      - name: output
        inputType: OutputTopic
        description: This is the output topic for alerts
        required: true
        value: metrics-alerts
      - name: parameterName
        inputType: FreeText
        description: This is the stream's parameter to track
        required: true
        value: memory
      - name: thresholdValue
        inputType: FreeText
        description: This is the threshold's numerical value
        required: true
        value: 1000000
      - name: bufferMilliSeconds
        inputType: FreeText
        description: How long to wait before waiting for threshold checking (milliseconds)
        required: true
        value: 1
      - name: METRIC_TYPE
        inputType: FreeText
        description: ''
        required: false
        value: node
  - name: CPU Alert Detector - nodes
    application: Threshold alert
    deploymentType: Service
    version: e4b050775ca4107c716ceff79116746f01547944
    resources:
      cpu: 200
      memory: 500
      replicas: 1
    desiredStatus: Running
    variables:
      - name: input
        inputType: InputTopic
        description: This is the input topic for raw data
        required: true
        value: k8s-metrics
      - name: output
        inputType: OutputTopic
        description: This is the output topic for alerts
        required: true
        value: metrics-alerts
      - name: parameterName
        inputType: FreeText
        description: This is the stream's parameter to track
        required: true
        value: cpu
      - name: thresholdValue
        inputType: FreeText
        description: This is the threshold's numerical value
        required: true
        value: 1000000
      - name: bufferMilliSeconds
        inputType: FreeText
        description: How long to wait before waiting for threshold checking (milliseconds)
        required: true
        value: 1
      - name: METRIC_TYPE
        inputType: FreeText
        description: ''
        required: false
        value: node
  - name: CPU Alert Detector - pods (default)
    application: Threshold alert
    deploymentType: Service
    version: 49f8ca5c3c9ff5350b27fa9888ab40a73d462f87
    resources:
      cpu: 200
      memory: 500
      replicas: 1
    desiredStatus: Running
    variables:
      - name: input
        inputType: InputTopic
        description: This is the input topic for raw data
        required: true
        value: k8s-metrics
      - name: output
        inputType: OutputTopic
        description: This is the output topic for alerts
        required: true
        value: metrics-alerts
      - name: parameterName
        inputType: FreeText
        description: This is the stream's parameter to track
        required: true
        value: cpu
      - name: thresholdValue
        inputType: FreeText
        description: This is the threshold's numerical value
        required: true
        value: ' 1000000000'
      - name: bufferMilliSeconds
        inputType: FreeText
        description: How long to wait before waiting for threshold checking (milliseconds)
        required: true
        value: 1
      - name: METRIC_TYPE
        inputType: FreeText
        description: ''
        required: false
        value: pod
  - name: Memory Alert Detector - pods (default)
    application: Threshold alert
    deploymentType: Service
    version: 49f8ca5c3c9ff5350b27fa9888ab40a73d462f87
    resources:
      cpu: 200
      memory: 500
      replicas: 1
    desiredStatus: Running
    variables:
      - name: input
        inputType: InputTopic
        description: This is the input topic for raw data
        required: true
        value: k8s-metrics
      - name: output
        inputType: OutputTopic
        description: This is the output topic for alerts
        required: true
        value: metrics-alerts
      - name: parameterName
        inputType: FreeText
        description: This is the stream's parameter to track
        required: true
        value: memory
      - name: thresholdValue
        inputType: FreeText
        description: This is the threshold's numerical value
        required: true
        value: 1000000
      - name: bufferMilliSeconds
        inputType: FreeText
        description: How long to wait before waiting for threshold checking (milliseconds)
        required: true
        value: 1
      - name: METRIC_TYPE
        inputType: FreeText
        description: ''
        required: false
        value: pod

# This section describes the Topics of the data pipeline
topics:
  - name: k8s-logs
    persisted: false
    configuration:
      partitions: 1
      replicationFactor: 2
      retentionInMinutes: 1440
      retentionInBytes: 52428800
  - name: k8s-metrics
    persisted: false
    configuration:
      partitions: 1
      replicationFactor: 2
      retentionInMinutes: 1440
      retentionInBytes: 52428800
  - name: metrics-alerts
    persisted: false
    configuration:
      partitions: 1
      replicationFactor: 2
      retentionInMinutes: 1440
      retentionInBytes: 52428800
